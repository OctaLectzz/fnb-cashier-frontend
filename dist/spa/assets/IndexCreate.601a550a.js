import{r as q,o as J,w as N,c as G,x as v,y as x,j as t,C as o,ag as C,ah as f,ae as a,aj as e,ay as H,ad as V,ak as b,aF as w,ax as c,az as z,ai as Z,av as d,aw as tt,F as D,af as F,B as K,bs as at,a$ as et,br as st,aG as ot}from"./index.199a5e3f.js";import{Q as lt}from"./QSelect.0341fc00.js";import{Q as nt}from"./QResponsive.500fc61e.js";import{u as dt}from"./use-quasar.cb6e291d.js";import{url as O}from"./axios.afd0666a.js";import{rupiah as h}from"./rupiah.ed064363.js";import{u as it}from"./category-store.2a0162d0.js";import{a as rt,C as W,Q as R}from"./ClosePopup.e69073b2.js";import{Q as $,a as p}from"./QItem.37ed3076.js";import{Q as ct}from"./QSpinnerGears.7e50aff2.js";import{Q as ut}from"./QForm.fdbdeff7.js";import{l as Y}from"./index.1757aa92.js";import{u as mt}from"./setting-store.40679274.js";import{u as pt}from"./transaction-store.349b117a.js";import{u as X}from"./vue-i18n.runtime.bdb4f456.js";import"./QItemLabel.5bbf1fb7.js";import"./QMenu.7c4a117a.js";import"./selection.75008187.js";import"./format.2cae61da.js";import"./use-ratio.8bb329cf.js";const _t={class:"text-h6"},ht={class:"row justify-center"},vt={class:"col-lg-8 col-md-7 col-xs-12 q-pa-md"},yt={class:"text-body1 text-bold"},bt={class:"row justify-center"},ft={class:"col-md-7 col-xs-12 q-pa-sm"},gt={class:"text-bold"},xt={class:"text-red"},qt={class:"col-md-3 col-xs-12 q-pa-sm"},$t={class:"text-bold"},wt={class:"text-grey"},Ct={class:"col-md-10 col-xs-12 q-pa-sm"},kt={class:"text-bold"},Qt={class:"text-grey"},Vt={class:"text-body1 text-bold"},At={class:"row q-my-sm"},Tt={class:"col-5 text-body1 text-bold"},St={class:"col-5"},Bt={class:"row q-my-sm"},It={class:"col-5 text-body1 text-bold"},Pt={class:"col-5"},jt={class:"row q-my-md"},zt={class:"col-5 flex items-center text-h6 text-bold"},Dt={class:"col-5"},Ft={class:"bg-blue-2 rounded-borders"},Ut={class:"text-blue-8 text-h5 text-bold text-center q-pa-sm"},Et={class:"row q-my-md"},Lt={class:"col-5 flex items-center text-h6 text-bold"},Mt={class:"col-5"},Nt={class:"bg-green-2 rounded-borders"},Rt={class:"text-green-8 text-h5 text-bold text-center q-pa-sm"},Gt={class:"col-lg-3 col-md-4 col-xs-12 q-pa-md"},Ot={class:"text-body1 text-bold"},Ht={class:"row justify-center"},Wt=["src"],Yt={class:"text-h6 text-center text-bold"},Jt={class:"text-body2 text-center"},Kt={class:"row"},Xt={class:"col text-grey text-left"},Zt={class:"col text-grey text-right"},ta={class:"text-center text-caption text-grey"},aa={__name:"DetailCreate",props:["item"],emits:["created"],setup(T,{emit:k}){const{t:u}=X(),U=k,s=q({name:T.item.name,payment_type:T.item.payment_type,total_price:T.item.total_price,discount:0,payment_amount:0,money_amount:0,change_amount:0,notes:"",transactiondetails:T.item.transactiondetails}),y=q({}),I=async()=>{try{const n=await mt().show(1);y.value=n.data.data}catch(n){console.error("Error fetching data:",n)}};J(()=>{I()});const P=()=>{const n=s.value.discount/100*s.value.total_price;s.value.payment_amount=s.value.total_price-n},S=()=>{s.value.change_amount=s.value.money_amount-s.value.payment_amount};N(()=>s.value.discount,P),N(()=>s.value.payment_amount,S),N(()=>s.value.money_amount,()=>{P(),S()});const Q=q(!1),E=G(()=>Q.value||!s.value.money_amount),A=async()=>{Q.value=!0;try{await pt().create(s.value),Y.success(u("dashboard.main.transaction.successCreateMsg")),U("created"),M()}catch(n){console.error("Error submitting form:",n),Y.error(n.response.data.message||u("dashboard.main.transaction.failedCreateMsg"))}Q.value=!1},B=q({money_amount:G({get(){return h(s.value.money_amount)},set(n){const i=n.replace(/[^\d]/g,"");s.value.money_amount=parseInt(i,10)||0}})}),L=n=>{B.value[n]=h(s.value[n])},M=()=>{const n=document.getElementById("print-section").innerHTML,i=window.open("","","width=80mm,height=auto");i.document.write(`
  <html>
    <head>
      <title>Print Receipt</title>
      <link href="https://cdn.jsdelivr.net/npm/quasar@latest/dist/quasar.min.css" rel="stylesheet">
      <style>
        @page { size: 80mm auto; margin: 0; }
        body { margin: 0; font-family: Arial, sans-serif; }
        .receipt-print { width: 80mm; padding: 10px; }
      </style>
    </head>
    <body>
      ${n}
    </body>
  </html>
`),i.document.close(),i.onload=()=>{i.print()}};return(n,i)=>(v(),x("div",null,[t(ut,{onSubmit:A},{default:o(()=>[t(C,{style:{"min-width":"400px"}},{default:o(()=>[t(f,{class:"row items-center q-py-sm"},{default:o(()=>[a("div",_t,e(n.$t("dashboard.main.transaction.detailText")),1),t(rt),H(t(V,{icon:"close",flat:"",round:"",dense:""},null,512),[[W]])]),_:1}),t(b),t(f,{class:"scroll",style:{height:"77vh"}},{default:o(()=>[a("div",ht,[a("div",vt,[t(C,{class:"q-mb-md"},{default:o(()=>[t(f,{class:w(n.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:o(()=>[a("div",yt,e(n.$t("dashboard.main.transaction.detailCard")),1)]),_:1},8,["class"]),t(b),t(f,{class:"q-pa-md"},{default:o(()=>[a("div",bt,[a("div",ft,[a("div",gt,[c(e(n.$t("dashboard.main.transaction.data.moneyAmount"))+" ",1),a("span",xt,e(n.$t("public.requiredText")),1)]),t(z,{modelValue:B.value.money_amount,"onUpdate:modelValue":i[0]||(i[0]=_=>B.value.money_amount=_),onInput:i[1]||(i[1]=_=>L("money_amount")),outlined:"",dense:"",required:"",autofocus:""},null,8,["modelValue"])]),a("div",qt,[a("div",$t,[c(e(n.$t("dashboard.main.transaction.data.discount"))+" ",1),a("span",wt,e(n.$t("public.optionalText")),1)]),t(z,{modelValue:s.value.discount,"onUpdate:modelValue":i[2]||(i[2]=_=>s.value.discount=_),type:"number",outlined:"",dense:""},{append:o(()=>[t(Z,{name:"percent"})]),_:1},8,["modelValue"])]),a("div",Ct,[a("div",kt,[c(e(n.$t("dashboard.main.transaction.data.notes"))+" ",1),a("span",Qt,e(n.$t("public.optionalText")),1)]),t(z,{modelValue:s.value.notes,"onUpdate:modelValue":i[3]||(i[3]=_=>s.value.notes=_),type:"textarea",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1})]),_:1}),t(C,{class:"q-mt-md"},{default:o(()=>[t(f,{class:w(n.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:o(()=>[a("div",Vt,e(n.$t("dashboard.main.transaction.paymentDetailsCard")),1)]),_:1},8,["class"]),t(b),t(f,{class:"q-pa-md"},{default:o(()=>[a("div",At,[a("div",Tt,e(n.$t("dashboard.main.transaction.data.totalPrice")),1),i[4]||(i[4]=a("div",{class:"col-2"},":",-1)),a("div",St,e(d(h)(s.value.total_price)),1)]),a("div",Bt,[a("div",It,e(n.$t("dashboard.main.transaction.data.discount")),1),i[5]||(i[5]=a("div",{class:"col-2"},":",-1)),a("div",Pt,e(s.value.discount+"%"),1)]),a("div",jt,[a("div",zt,e(n.$t("dashboard.main.transaction.data.paymentAmount")),1),i[6]||(i[6]=a("div",{class:"col-2 flex items-center"},":",-1)),a("div",Dt,[a("div",Ft,[a("div",Ut,e(d(h)(s.value.payment_amount)),1)])])]),a("div",Et,[a("div",Lt,e(n.$t("dashboard.main.transaction.data.changeAmount")),1),i[7]||(i[7]=a("div",{class:"col-2 flex items-center"},":",-1)),a("div",Mt,[a("div",Nt,[a("div",Rt,e(d(h)(s.value.change_amount)),1)])])])]),_:1})]),_:1})]),a("div",Gt,[t(C,{class:"q-pb-xl",style:{height:"100%"}},{default:o(()=>[t(f,{class:w(n.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:o(()=>[a("div",Ot,e(n.$t("dashboard.main.transaction.noteCard")),1)]),_:1},8,["class"]),t(b),t(f,{id:"print-section",class:"q-pa-md"},{default:o(()=>[a("div",Ht,[a("img",{src:d(O)+"/settings/"+y.value.logo,style:tt("width:"+y.value.logo_size+"px")},null,12,Wt)]),a("div",Yt,e(y.value.title),1),a("div",Jt,e(y.value.address),1),t(b,{class:"q-my-md"}),t(R,{dense:""},{default:o(()=>[t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.name")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(s.value.name),1)]),_:1})]),_:1}),t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.paymentType")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(s.value.payment_type),1)]),_:1})]),_:1})]),_:1}),t(b,{class:"q-my-md"}),t(R,{dense:""},{default:o(()=>[(v(!0),x(D,null,F(s.value.transactiondetails,_=>(v(),K($,{key:_.id,class:"column"},{default:o(()=>[t(p,{class:"text-bold"},{default:o(()=>[c(e(_.name),1)]),_:2},1024),a("div",Kt,[a("div",Xt,e(d(h)(_.product_price))+" x"+e(_.quantity),1),a("div",Zt,e(d(h)(_.total_price)),1)])]),_:2},1024))),128))]),_:1}),t(b,{class:"q-my-md"}),t(R,{dense:""},{default:o(()=>[t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.totalPrice")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(d(h)(s.value.total_price)),1)]),_:1})]),_:1}),t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.discount")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(s.value.discount)+"%",1)]),_:1})]),_:1}),t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.paymentAmount")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(d(h)(s.value.payment_amount)),1)]),_:1})]),_:1}),t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.moneyAmount")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(d(h)(s.value.money_amount)),1)]),_:1})]),_:1}),t($,null,{default:o(()=>[t(p,null,{default:o(()=>[c(e(d(u)("dashboard.main.transaction.data.changeAmount")),1)]),_:1}),t(p,{side:""},{default:o(()=>[c(e(d(h)(s.value.change_amount)),1)]),_:1})]),_:1})]),_:1}),t(b,{class:"q-my-md"}),a("div",ta,e(d(u)("dashboard.main.transaction.thankYouMsg")),1)]),_:1})]),_:1})])])]),_:1}),t(b),t(at,{align:"right",class:"text-primary"},{default:o(()=>[H(t(V,{color:"primary",label:d(u)("public.cancelText"),flat:""},null,8,["label"]),[[W]]),t(V,{type:"submit",color:"primary",label:d(u)("dashboard.main.transaction.printNotaBtn"),loading:Q.value,disable:E.value,"no-caps":""},{loading:o(()=>[t(ct)]),_:1},8,["label","loading","disable"])]),_:1})]),_:1})]),_:1})]))}},ea={class:"row justify-center q-ma-lg"},sa={class:"col-md-8 col-xs-12 q-pa-sm"},oa={class:"row justify-center"},la={class:"col-md-6 col-xs-12 q-pa-sm"},na={class:"text-bold"},da={class:"text-red"},ia={class:"col-md-6 col-xs-12 q-pa-sm"},ra={class:"text-bold"},ca={class:"text-red"},ua={class:"col-12 q-pa-sm"},ma={class:"text-h6 text-bold"},pa={class:"row"},_a=["onClick"],ha=["src"],va={class:"text-subtitle2 text-bold q-my-xs q-pb-md",style:{"line-height":"15px"}},ya={class:"text-caption absolute absolute-bottom-left q-px-sm q-py-xs"},ba={key:0},fa={class:"text-h6 text-grey text-bold"},ga={class:"col-md-4 col-xs-12 q-pa-sm"},xa=["src"],qa={class:"text-body2"},$a={class:"text-caption"},wa={class:"absolute absolute-bottom-right q-pa-sm"},Ca={class:"text-body1 q-mx-sm"},ka={class:"q-py-sm"},Ha={__name:"IndexCreate",setup(T){const k=dt(),{t:u}=X(),U=et(),s=q({name:"",payment_type:"",total_price:0,transactiondetails:[]}),y=q(!1),I=q([]),P=async()=>{try{const l=await it().all();I.value=l.data.data}catch(l){console.error("Error fetching data:",l),l.response.data.status==="failed"&&U.push("/notfound")}};J(()=>{P()});const S=q([{label:u("dashboard.main.transaction.data.cash"),value:"cash"},{label:u("dashboard.main.transaction.data.qris"),value:"qris"},{label:u("dashboard.main.transaction.data.others"),value:"others"}]),Q=q(S),E=(l,m,r)=>{m(()=>{const g=l.toLowerCase();Q.value=S.value.filter(j=>j.value.toLowerCase().indexOf(g)>-1)})},A=()=>{s.value.total_price=s.value.transactiondetails.reduce((l,m)=>l+m.total_price,0)},B=l=>{const m=s.value.transactiondetails.find(r=>r.product_id===l.id);m?(m.quantity++,m.total_price=m.quantity*l.purchase_price):s.value.transactiondetails.push({product_id:l.id,name:l.name,image:l.image,purchase_price:l.purchase_price,total_price:l.purchase_price,quantity:1}),A()},L=l=>{l.quantity++,l.total_price=l.quantity*l.purchase_price,A()},M=l=>{l.quantity>1?(l.quantity--,l.total_price=l.quantity*l.purchase_price):s.value.transactiondetails=s.value.transactiondetails.filter(m=>m.product_id!==l.product_id),A()},n=()=>{s.value.transactiondetails=[],A()},i=G(()=>!s.value.name||!s.value.payment_type||s.value.transactiondetails==0),_=()=>{y.value=!1,s.value={name:"",payment_type:"",total_price:0,notes:"",transactiondetails:[]}};return(l,m)=>(v(),x("div",ea,[a("div",sa,[t(C,{class:w([d(k).dark.isActive?"text-grey-4":"text-grey-9","dashboard-card q-pa-md"])},{default:o(()=>[a("div",oa,[a("div",la,[a("div",na,[c(e(l.$t("dashboard.main.transaction.data.name"))+" ",1),a("span",da,e(l.$t("public.requiredText")),1)]),t(z,{modelValue:s.value.name,"onUpdate:modelValue":m[0]||(m[0]=r=>s.value.name=r),placeholder:l.$t("dashboard.main.transaction.data.namePlaceholder"),outlined:"",dense:"",required:"",autofocus:""},null,8,["modelValue","placeholder"])]),a("div",ia,[a("div",ra,[c(e(l.$t("dashboard.main.transaction.data.paymentType"))+" ",1),a("span",ca,e(l.$t("public.requiredText")),1)]),t(lt,{modelValue:s.value.payment_type,"onUpdate:modelValue":m[1]||(m[1]=r=>s.value.payment_type=r),options:Q.value,placeholder:l.$t("dashboard.main.transaction.data.paymentTypePlaceholder"),onFilter:E,"input-debounce":"0","use-input":"","fill-input":"","emit-value":"","hide-selected":"",outlined:"",dense:"",required:""},null,8,["modelValue","options","placeholder"])]),a("div",ua,[t(V,{color:"primary",label:d(u)("dashboard.main.transaction.checkoutBtn"),disable:i.value,class:"full-width q-my-md",onClick:m[3]||(m[3]=r=>y.value=!0),"no-caps":""},{default:o(()=>[t(st,{modelValue:y.value,"onUpdate:modelValue":m[2]||(m[2]=r=>y.value=r),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"","full-height":"",persistent:""},{default:o(()=>[t(aa,{onCreated:_,item:s.value},null,8,["item"])]),_:1},8,["modelValue"])]),_:1},8,["label","disable"])])]),(v(!0),x(D,null,F(I.value,r=>(v(),x("div",{key:r.id,class:"q-my-sm"},[a("div",ma,e(r.name),1),a("div",pa,[(v(!0),x(D,null,F(r.products,g=>(v(),x("div",{key:g.id,class:"dashboard-card q-pa-sm col-xs-6 col-sm-3 col-md-3 col-lg-3 grid-style-transition",onClick:j=>B(g)},[t(C,{class:w([d(k).dark.isActive?"bg-grey-9":"bg-grey-2","dashboard-transaction-card q-pa-sm"]),flat:"",bordered:""},{default:o(()=>[t(nt,{ratio:1/1,style:{width:"100%"}},{default:o(()=>[a("img",{src:d(O)+"/products/"+g.image,class:"dashboard-transaction-image"},null,8,ha)]),_:2},1024),a("div",va,e(g.name),1),a("div",ya,e(d(h)(g.purchase_price)),1)]),_:2},1032,["class"])],8,_a))),128)),r.products.length==0?(v(),x("div",ba,[a("div",fa,e(l.$t("dashboard.main.transaction.noProductText")),1)])):ot("",!0)])]))),128))]),_:1},8,["class"])]),a("div",ga,[t(C,{class:w([d(k).dark.isActive?"text-grey-4":"text-grey-9","dashboard-card q-pa-md"])},{default:o(()=>[t(V,{color:"red",label:d(u)("dashboard.main.transaction.resetBtn"),disable:s.value.transactiondetails==0,class:"full-width q-my-sm","no-caps":"",onClick:n},null,8,["label","disable"]),(v(!0),x(D,null,F(s.value.transactiondetails,(r,g)=>(v(),K(C,{key:g,class:w([d(k).dark.isActive?"bg-grey-9":"bg-grey-2","q-my-xs"]),style:{"border-radius":"8px"},flat:""},{default:o(()=>[t(f,{class:"q-pa-sm",horizontal:""},{default:o(()=>[a("img",{src:d(O)+"/products/"+r.image,class:"col-3",style:{width:"60px",height:"60px","border-radius":"5px"}},null,8,xa),t(f,{class:"q-px-sm q-py-xs",style:{"line-height":"15px"}},{default:o(()=>[a("div",qa,e(r.name),1),a("div",$a,e(d(h)(r.total_price)),1)]),_:2},1024),a("div",wa,[t(V,{color:"primary",size:"10px",icon:"remove",onClick:j=>M(r),square:"",dense:""},null,8,["onClick"]),a("span",Ca,e(r.quantity),1),t(V,{color:"primary",size:"10px",icon:"add",onClick:j=>L(r),square:"",dense:""},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]))),128)),a("div",{class:w(["text-h6 text-bold text-center q-my-md",d(k).dark.isActive?"bg-grey-9":"bg-grey-2"])},[t(b),a("div",ka,e(d(u)("dashboard.main.transaction.totalPrice"))+": "+e(d(h)(s.value.total_price)),1)],2)]),_:1},8,["class"])])]))}};export{Ha as default};
