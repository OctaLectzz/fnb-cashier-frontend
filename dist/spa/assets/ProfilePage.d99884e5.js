import{Q as f}from"./QSkeleton.f97d26c8.js";import{Q as S}from"./QForm.fdbdeff7.js";import{aE as O,a$ as H,r as c,o as T,c as J,au as K,x as w,B as k,C as r,ae as a,j as s,ah as p,aF as q,aj as o,ak as x,av as g,ad as _,ag as $,ax as U,az as m,ay as W}from"./index.199a5e3f.js";import{Q as X}from"./QAvatar.48e197fa.js";import{Q as Y}from"./QSpinnerGears.7e50aff2.js";import{Q as Z}from"./QPage.2ef07c91.js";import{l as A}from"./index.1757aa92.js";import{server as v,headers as C,headersImage as B,url as V}from"./axios.afd0666a.js";import{u as R}from"./profile-store.e8397c42.js";import{u as ee}from"./vue-i18n.runtime.bdb4f456.js";const ae=O("user",{actions:{async all(){return await v.get("api/user",{headers:C})},async show(d){return await v.get(`api/user/${d}`,{headers:C})},async create(d){return await v.post("api/user",d,{headers:B})},async edit(d){return await v.post(`api/user/${d.id}`,d,{headers:B})},async delete(d){return await v.delete(`api/user/${d}`,{headers:C})}}}),te={class:"row justify-center"},se={class:"col-md-3 col-xs-11 q-pa-md"},le={class:"col-md-8 col-xs-11 q-pa-md"},oe={class:"col-md-11 col-xs-11 q-pa-md"},re={class:"row justify-center"},ie={class:"col-md-3 col-xs-11 q-pa-md"},ne={class:"text-body1 text-bold"},de=["src"],ue={class:"text-subtitle2 text-grey-7"},ce={class:"col-md-8 col-xs-11 q-pa-md"},pe={class:"text-body1 text-bold"},me={class:"row justify-center"},ve={class:"col-11 q-pa-sm"},he={class:"text-bold"},fe={class:"text-red"},ge={class:"col-11 q-pa-sm"},_e={class:"text-bold"},ye={class:"text-red"},be={class:"col-11 q-pa-sm"},we={class:"text-bold"},ke={class:"col-11 q-pa-md"},qe={class:"text-body1 text-bold"},xe={class:"row justify-center"},$e={class:"col-md-5 col-xs-11 q-pa-sm"},Ce={class:"text-bold"},Ve={class:"col-md-5 col-xs-11 q-pa-sm"},Ie={class:"text-bold"},Qe={class:"col-md-5 col-xs-11 text-center q-pa-sm"},Fe={class:"text-bold q-mt-md"},Pe=["src"],De={class:"text-subtitle2 text-grey-7"},Se={class:"col-md-5 col-xs-11 text-center q-pa-sm"},Te={class:"text-bold q-mt-md"},Ue=["src"],Ae={class:"text-subtitle2 text-grey-7"},He={__name:"ProfilePage",setup(d){const{t:u}=ee(),j=H(),y=c(!0),l=c({id:null,avatar:"",name:"",email:"",phone_number:"",ktp:"",ktp_image:"",npwp:"",npwp_image:""}),E=async()=>{y.value=!0;try{const e=await R().profile();l.value=e.data.data}catch(e){console.error("Error fetching data:",e)}y.value=!1};T(()=>{E()});const b=c([]),L=async()=>{try{const e=await ae().all();b.value=e.data.data}catch(e){console.error("Error fetching data:",e)}};T(()=>{L()});const I=c(null),M=async e=>{e.preventDefault();const t=e.target.files[0];if(l.value.avatar=t,t){const i=new FileReader;i.onload=()=>{I.value.src=i.result},i.readAsDataURL(t)}},Q=c(null),N=async e=>{e.preventDefault();const t=e.target.files[0];if(l.value.ktp_image=t,t){const i=new FileReader;i.onload=()=>{Q.value.src=i.result},i.readAsDataURL(t)}},F=c(null),z=async e=>{e.preventDefault();const t=e.target.files[0];if(l.value.npwp_image=t,t){const i=new FileReader;i.onload=()=>{F.value.src=i.result},i.readAsDataURL(t)}},P=c({name:[e=>!!e||u("auth.validate.nameRequired"),e=>e.length<=50||u("auth.validate.nameMaxLength")],email:[e=>!!e||u("auth.validate.emailRequired"),e=>/.+@.+/.test(e)||u("auth.validate.emailFormat"),e=>typeof e=="string"&&b.value?!b.value.some(t=>t.email.toLowerCase()===e.toLowerCase()&&t.id!==l.value.id)||u("auth.validate.emailAlready"):!0]}),h=c(!1),G=J(()=>h.value||!l.value.name||!l.value.email),D=async()=>{h.value=!0;try{await R().editprofile(l.value),A.success(u("profile.successProfileEditMsg")),j.back(),setTimeout(()=>{window.location.reload()},100)}catch(e){console.error("Error submitting form:",e),A.success(u("profile.successProfileEditMsg"))}h.value=!1};return(e,t)=>{const i=K("lowercase");return w(),k(Z,{class:"q-py-md"},{default:r(()=>[y.value?(w(),k(S,{key:0,onSubmit:D},{default:r(()=>[a("div",te,[a("div",se,[s(f,{width:"100%",height:"400px"})]),a("div",le,[s(f,{width:"100%",height:"400px"})]),a("div",oe,[s(f,{width:"100%",height:"500px"})])]),s(f,{width:"90px",height:"38px",class:"float-right q-mx-xl"})]),_:1})):(w(),k(S,{key:1,onSubmit:D},{default:r(()=>[a("div",re,[a("div",ie,[s($,{class:"q-pb-xl"},{default:r(()=>[s(p,{class:q(e.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:r(()=>[a("div",ne,o(e.$t("profile.profilePictureCard")),1)]),_:1},8,["class"]),s(x),s(p,{class:"text-center q-pa-md"},{default:r(()=>[s(X,{size:"100px",class:"q-my-md"},{default:r(()=>[a("img",{ref_key:"avatar",ref:I,src:g(V)+"/users/avatars/"+l.value.avatar},null,8,de)]),_:1}),a("div",ue,o(e.$t("public.imageType")),1),s(_,{color:"primary",class:"q-my-md",label:e.$t("public.uploadBtn"),onClick:t[0]||(t[0]=n=>e.$refs.avatarInput.click()),"no-caps":""},null,8,["label"]),a("input",{type:"file",ref:"avatarInput",id:"avatarInput",style:{display:"none"},accept:"image/*",onChange:M},null,544)]),_:1})]),_:1})]),a("div",ce,[s($,{class:"q-pb-xl",style:{height:"100%"}},{default:r(()=>[s(p,{class:q(e.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:r(()=>[a("div",pe,o(e.$t("profile.profileAccountInformationCard")),1)]),_:1},8,["class"]),s(x),s(p,{class:"q-pa-sm"},{default:r(()=>[a("div",me,[a("div",ve,[a("div",he,[U(o(e.$t("auth.nameForm"))+" ",1),a("span",fe,o(e.$t("public.requiredText")),1)]),s(m,{modelValue:l.value.name,"onUpdate:modelValue":t[1]||(t[1]=n=>l.value.name=n),placeholder:"Octavyan Putra",rules:P.value.name,outlined:"",dense:"",required:"",autofocus:""},null,8,["modelValue","rules"])]),a("div",ge,[a("div",_e,[U(o(e.$t("auth.emailForm"))+" ",1),a("span",ye,o(e.$t("public.requiredText")),1)]),W(s(m,{modelValue:l.value.email,"onUpdate:modelValue":t[2]||(t[2]=n=>l.value.email=n),type:"email",placeholder:"email@example.com",rules:P.value.email,outlined:"",dense:"",required:""},null,8,["modelValue","rules"]),[[i]])]),a("div",be,[a("div",we,o(e.$t("auth.phoneNumberForm")),1),s(m,{modelValue:l.value.phone_number,"onUpdate:modelValue":t[3]||(t[3]=n=>l.value.phone_number=n),placeholder:"0897 - 1234 - 4444",mask:"#### - #### - ######",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1})]),_:1})]),a("div",ke,[s($,{class:"q-pb-xl",style:{height:"100%"}},{default:r(()=>[s(p,{class:q(e.$q.dark.isActive?"bg-blue-grey-10":"bg-blue-grey-1")},{default:r(()=>[a("div",qe,o(e.$t("profile.personalDataInformationCard")),1)]),_:1},8,["class"]),s(x),s(p,{class:"q-pa-sm"},{default:r(()=>[a("div",xe,[a("div",$e,[a("div",Ce,o(e.$t("auth.ktpForm")),1),s(m,{modelValue:l.value.ktp,"onUpdate:modelValue":t[4]||(t[4]=n=>l.value.ktp=n),placeholder:e.$t("public.exampleText")+"3311040404040004",mask:"################",outlined:"",dense:""},null,8,["modelValue","placeholder"])]),a("div",Ve,[a("div",Ie,o(e.$t("auth.npwpForm")),1),s(m,{modelValue:l.value.npwp,"onUpdate:modelValue":t[5]||(t[5]=n=>l.value.npwp=n),placeholder:e.$t("public.exampleText")+"11.111.111.1.111",mask:"##.###.###.#.###",outlined:"",dense:""},null,8,["modelValue","placeholder"])]),a("div",Qe,[a("div",Fe,o(e.$t("auth.ktpPhotoForm")),1),a("img",{ref_key:"ktp_image",ref:Q,src:g(V)+"/users/ktps/"+l.value.ktp_image,width:"200"},null,8,Pe),a("div",De,o(e.$t("public.imageType")),1),s(_,{color:"primary",class:"q-my-md",label:e.$t("public.uploadBtn"),onClick:t[6]||(t[6]=n=>e.$refs.ktpInput.click()),"no-caps":""},null,8,["label"]),a("input",{type:"file",ref:"ktpInput",id:"ktpInput",style:{display:"none"},accept:"image/*",onChange:N},null,544)]),a("div",Se,[a("div",Te,o(e.$t("auth.npwpPhotoForm")),1),a("img",{ref_key:"npwp_image",ref:F,src:g(V)+"/users/npwps/"+l.value.npwp_image,width:"200"},null,8,Ue),a("div",Ae,o(e.$t("public.imageType")),1),s(_,{color:"primary",class:"q-my-md",label:e.$t("public.uploadBtn"),onClick:t[7]||(t[7]=n=>e.$refs.npwpInput.click()),"no-caps":""},null,8,["label"]),a("input",{type:"file",ref:"npwpInput",id:"npwpInput",style:{display:"none"},accept:"image/*",onChange:z},null,544)])])]),_:1})]),_:1})])]),s(_,{type:"submit",label:g(u)("public.saveText"),color:"primary",class:"float-right q-mx-xl q-mb-xl",loading:h.value,disable:G.value},{loading:r(()=>[s(Y)]),_:1},8,["label","loading","disable"])]),_:1}))]),_:1})}}};export{He as default};
