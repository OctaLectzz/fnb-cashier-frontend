import{aE as x,a_ as C,r as w,c as Q,x as V,B as S,C as l,a5 as a,j as r,a7 as $,a8 as b,aa as i,ab as k,av as m,ax as _,a9 as f,a4 as B}from"./index.4b455d6d.js";import{Q as T}from"./QSpinnerGears.2f99577e.js";import{Q as F}from"./QForm.9927cc01.js";import{Q as I}from"./QPage.588b5698.js";import{l as h}from"./index.820023a3.js";import{server as v,headers as g,headersImage as M}from"./axios.7d27b938.js";import{u as N}from"./vue-i18n.runtime.f1e77c75.js";const R=x("profile",{actions:{async profile(){return await v.get("api/profile",{headers:g})},async editprofile(u){return await v.post("api/profile",u,{headers:M})},async changepassword(u){return await v.post("api/profile/change-password",u,{headers:g})}}}),j={class:"row justify-center"},U={class:"col-md-8 col-xs-12 q-ma-md"},E={class:"text-body1 text-bold"},L={class:"row justify-center"},D={class:"col-10 q-pa-sm"},G={class:"small mb-1",for:"current_password"},z={class:"text-red"},A={class:"col-10 q-pa-sm"},H={class:"small mb-1",for:"new_password"},J={class:"text-red"},K={class:"col-10 q-pa-sm"},O={class:"small mb-1",for:"confirm_password"},W={class:"text-red"},os={__name:"ChangePasswordPage",setup(u){const{t:d}=N(),y=C(),t=w({current_password:"",new_password:"",confirm_password:""}),o=w({current_password:!0,new_password:!0,confirm_password:!0}),c=w({current_password:[s=>!!s||d("auth.validate.currentPasswordRequired"),s=>s.length>=8||d("auth.validate.currentPasswordMinLength")],new_password:[s=>!!s||d("auth.validate.newPasswordRequired"),s=>s.length>=8||d("auth.validate.newPasswordMinLength")],confirm_password:[s=>!!s||d("auth.validate.passwordConfirmationRequired"),s=>s===t.value.new_password||d("auth.validate.passwordConfirmationSame")]}),p=w(!1),q=Q(()=>p.value||!t.value.current_password||!t.value.new_password||!t.value.confirm_password),P=async()=>{p.value=!0;try{await R().changepassword(t.value),h.success(d("profile.successChangePasswordMsg")),y.back(),setTimeout(()=>{window.location.reload()},100)}catch(s){console.error("Error submitting form:",s),h.error(s.response.data.message||d("profile.failedChangePasswordMsg"))}p.value=!1};return(s,e)=>(V(),S(I,{class:"q-my-xl"},{default:l(()=>[e[7]||(e[7]=a("hr",{class:"q-my-md"},null,-1)),r(F,{onSubmit:P},{default:l(()=>[a("div",j,[a("div",U,[r($,{style:{height:"100%"}},{default:l(()=>[r(b,{class:"bg-blue-grey-1"},{default:l(()=>[a("div",E,i(s.$t("profile.changePasswordCard")),1)]),_:1}),r(k),r(b,{class:"q-pa-md q-pb-xl"},{default:l(()=>[a("div",L,[a("div",D,[a("label",G,[m(i(s.$t("auth.currentPasswordForm"))+" ",1),a("span",z,i(s.$t("public.requiredText")),1)]),r(_,{type:o.value.current_password?"password":"text",modelValue:t.value.current_password,"onUpdate:modelValue":e[1]||(e[1]=n=>t.value.current_password=n),id:"current_password",rules:c.value.current_password,outlined:"",dense:"",required:"",autofocus:""},{append:l(()=>[r(f,{name:o.value.current_password?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[0]||(e[0]=n=>o.value.current_password=!o.value.current_password)},null,8,["name"])]),_:1},8,["type","modelValue","rules"])]),a("div",A,[a("label",H,[m(i(s.$t("auth.newPasswordForm"))+" ",1),a("span",J,i(s.$t("public.requiredText")),1)]),r(_,{type:o.value.new_password?"password":"text",modelValue:t.value.new_password,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.new_password=n),id:"new_password",rules:c.value.new_password,outlined:"",dense:"",required:""},{append:l(()=>[r(f,{name:o.value.new_password?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[2]||(e[2]=n=>o.value.new_password=!o.value.new_password)},null,8,["name"])]),_:1},8,["type","modelValue","rules"])]),a("div",K,[a("label",O,[m(i(s.$t("auth.confirmNewPasswordForm"))+" ",1),a("span",W,i(s.$t("public.requiredText")),1)]),r(_,{type:o.value.confirm_password?"password":"text",modelValue:t.value.confirm_password,"onUpdate:modelValue":e[5]||(e[5]=n=>t.value.confirm_password=n),id:"confirm_password",rules:c.value.confirm_password,outlined:"",dense:"",required:""},{append:l(()=>[r(f,{name:o.value.confirm_password?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[4]||(e[4]=n=>o.value.confirm_password=!o.value.confirm_password)},null,8,["name"])]),_:1},8,["type","modelValue","rules"])])]),r(B,{type:"submit",label:"Simpan",color:"primary",class:"float-right q-ma-md",loading:p.value,disable:q.value},{loading:l(()=>[r(T)]),_:1},8,["loading","disable"])]),_:1})]),_:1})])]),e[6]||(e[6]=a("hr",{class:"q-my-md"},null,-1))]),_:1})]),_:1}))}};export{os as default};
